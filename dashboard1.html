<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard ‚Äî AiTelDa</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Instrument+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
:root{--bg:#050508;--surface:#0c0c14;--border:#1a1a2e;--accent:#00e5a0;--accent2:#ff4d00;--accent3:#7b61ff;--text:#e8e8f0;--muted:#6b6b80;--card:#0f0f1a;}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'Instrument Sans',sans-serif;min-height:100vh;cursor:none;display:flex;}
.cursor{position:fixed;width:10px;height:10px;background:var(--accent);border-radius:50%;pointer-events:none;z-index:9999;transform:translate(-50%,-50%);transition:width .15s,height .15s;}
.cursor-ring{position:fixed;width:36px;height:36px;border:1px solid rgba(0,229,160,0.4);border-radius:50%;pointer-events:none;z-index:9998;transform:translate(-50%,-50%);transition:width .3s,height .3s;}
body::after{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,229,160,0.018) 1px,transparent 1px),linear-gradient(90deg,rgba(0,229,160,0.018) 1px,transparent 1px);background-size:60px 60px;pointer-events:none;z-index:0;}
.sidebar{width:248px;min-height:100vh;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:50;overflow-y:auto;}
.sidebar-logo{padding:24px 22px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
.sidebar-logo a{font-family:'Syne',sans-serif;font-weight:800;font-size:1.3rem;letter-spacing:-0.02em;color:var(--text);text-decoration:none;}
.sidebar-logo a span{color:var(--accent);}
.logo-version{font-family:'Space Mono',monospace;font-size:0.55rem;color:var(--accent);background:rgba(0,229,160,0.1);border:1px solid rgba(0,229,160,0.2);padding:2px 6px;margin-left:auto;}
.sidebar-nav{flex:1;padding:10px 0;}
.nav-section-label{font-family:'Space Mono',monospace;font-size:0.55rem;color:var(--muted);letter-spacing:.2em;text-transform:uppercase;padding:14px 22px 6px;}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 22px;font-size:0.85rem;color:var(--muted);cursor:pointer;text-decoration:none;transition:background .2s,color .2s;position:relative;border-left:2px solid transparent;}
.nav-item:hover{background:rgba(0,229,160,0.04);color:var(--text);}
.nav-item.active{background:rgba(0,229,160,0.07);color:var(--text);border-left-color:var(--accent);}
.nav-icon{font-size:0.95rem;width:20px;text-align:center;flex-shrink:0;}
.nav-badge{margin-left:auto;font-family:'Space Mono',monospace;font-size:0.58rem;background:var(--accent2);color:#fff;padding:2px 6px;border-radius:2px;min-width:18px;text-align:center;}
.nav-badge.green{background:var(--accent);color:#000;}
.sidebar-footer{padding:18px 22px;border-top:1px solid var(--border);}
.user-chip{display:flex;align-items:center;gap:10px;}
.user-avatar{width:34px;height:34px;background:var(--accent);display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:800;font-size:0.8rem;color:#000;flex-shrink:0;}
.user-info{flex:1;min-width:0;}
.user-name{font-size:0.84rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.user-role{font-family:'Space Mono',monospace;font-size:0.58rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;}
.logout-btn{background:none;border:none;color:var(--muted);cursor:pointer;font-size:0.9rem;transition:color .2s;padding:4px;}
.logout-btn:hover{color:var(--accent2);}
.main{margin-left:248px;flex:1;display:flex;flex-direction:column;min-height:100vh;position:relative;z-index:1;}
.topbar{padding:18px 34px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:rgba(5,5,8,0.85);backdrop-filter:blur(16px);position:sticky;top:0;z-index:40;}
.topbar h1{font-family:'Syne',sans-serif;font-size:1.1rem;font-weight:700;}
.topbar-sub{font-family:'Space Mono',monospace;font-size:0.6rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-top:2px;}
.sentinel-pill{display:flex;align-items:center;gap:6px;padding:7px 14px;border:1px solid rgba(0,229,160,0.2);background:rgba(0,229,160,0.05);font-family:'Space Mono',monospace;font-size:0.62rem;color:var(--accent);letter-spacing:.08em;text-transform:uppercase;}
.sentinel-pill.off{border-color:rgba(255,77,0,0.2);background:rgba(255,77,0,0.05);color:var(--accent2);}
.pulse-dot{width:6px;height:6px;border-radius:50%;animation:pulse 2s ease-in-out infinite;}
.pulse-dot.on{background:var(--accent);}
.pulse-dot.off{background:var(--accent2);animation:none;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.4;transform:scale(.8);}}

/* KILL SWITCH */
.ks-bar{background:var(--surface);border-bottom:1px solid var(--border);padding:14px 34px;display:flex;align-items:center;gap:22px;flex-wrap:wrap;}
.ks-toggle{position:relative;width:54px;height:28px;cursor:pointer;flex-shrink:0;}
.ks-toggle input{display:none;}
.ks-track{width:100%;height:100%;background:var(--border);border-radius:14px;transition:background .3s;position:relative;border:1px solid rgba(255,255,255,.05);}
.ks-toggle input:checked~.ks-track{background:var(--accent);box-shadow:0 0 18px rgba(0,229,160,.35);}
.ks-thumb{position:absolute;top:3px;left:3px;width:20px;height:20px;background:#fff;border-radius:50%;transition:transform .3s;box-shadow:0 2px 6px rgba(0,0,0,.4);}
.ks-toggle input:checked~.ks-track .ks-thumb{transform:translateX(26px);}
.ks-label{min-width:160px;}
.ks-label strong{font-family:'Space Mono',monospace;font-size:0.78rem;display:block;margin-bottom:2px;}
.ks-label span{font-size:0.8rem;color:var(--muted);}
.ks-sep{width:1px;background:var(--border);align-self:stretch;}
.ks-stat{text-align:center;padding:0 18px;}
.ks-stat .val{font-family:'Syne',sans-serif;font-size:1.5rem;font-weight:800;line-height:1;}
.ks-stat .lbl{font-family:'Space Mono',monospace;font-size:0.58rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;margin-top:3px;}
.ks-savings{margin-left:auto;text-align:right;}
.ks-savings .big{font-family:'Syne',sans-serif;font-size:2rem;font-weight:800;color:var(--accent);line-height:1;}
.ks-savings .lbl{font-family:'Space Mono',monospace;font-size:0.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;margin-top:3px;}

/* TICKER */
.live-ticker{background:rgba(0,229,160,0.03);border-bottom:1px solid var(--border);padding:10px 34px;display:flex;align-items:center;gap:16px;overflow:hidden;}
.ticker-label{font-family:'Space Mono',monospace;font-size:0.6rem;color:var(--accent);text-transform:uppercase;letter-spacing:.1em;flex-shrink:0;display:flex;align-items:center;gap:5px;}
.ticker-scroll{flex:1;overflow:hidden;}
.ticker-inner{display:flex;gap:48px;animation:ticker 20s linear infinite;white-space:nowrap;}
.ticker-item{font-family:'Space Mono',monospace;font-size:0.65rem;color:var(--muted);flex-shrink:0;}
.ticker-item .green{color:var(--accent);}
.ticker-item .red{color:var(--accent2);}
@keyframes ticker{0%{transform:translateX(0);}100%{transform:translateX(-50%);}}

.content{padding:26px 34px;flex:1;}

/* STATS */
.stats-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:14px;margin-bottom:22px;}
.stat-card{background:var(--card);border:1px solid var(--border);padding:18px;position:relative;overflow:hidden;transition:border-color .2s,transform .2s;}
.stat-card:hover{border-color:rgba(0,229,160,.2);transform:translateY(-2px);}
.stat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;}
.s1::before{background:var(--accent);}
.s2::before{background:var(--accent2);}
.s3::before{background:#ffbd2e;}
.s4::before{background:var(--accent3);}
.s5::before{background:var(--accent);}
.stat-label{font-family:'Space Mono',monospace;font-size:0.56rem;color:var(--muted);text-transform:uppercase;letter-spacing:.12em;margin-bottom:8px;}
.stat-value{font-family:'Syne',sans-serif;font-size:1.65rem;font-weight:800;line-height:1;}
.stat-sub{font-family:'Space Mono',monospace;font-size:0.56rem;color:var(--muted);margin-top:6px;}
.stat-sub .up{color:var(--accent);}
.stat-sub .dn{color:var(--accent2);}
.stat-icon{position:absolute;top:14px;right:14px;font-size:1.2rem;opacity:.13;}
.sparkline{display:flex;align-items:flex-end;gap:2px;margin-top:10px;height:24px;}
.sp-bar{flex:1;border-radius:1px;min-height:2px;}

/* PANELS */
.panel{background:var(--card);border:1px solid var(--border);}
.ph{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;}
.ph .pt{font-family:'Syne',sans-serif;font-size:.95rem;font-weight:700;}
.ph .tag{font-family:'Space Mono',monospace;font-size:.58rem;letter-spacing:.08em;padding:4px 9px;border:1px solid var(--border);color:var(--muted);}
.ph .tag.accent{color:var(--accent);border-color:rgba(0,229,160,.2);background:rgba(0,229,160,.05);}
.ph .tag.danger{color:var(--accent2);border-color:rgba(255,77,0,.2);background:rgba(255,77,0,.05);}
.pb{padding:20px;}

.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;}
.grid3{display:grid;grid-template-columns:2fr 1fr 1fr;gap:16px;margin-bottom:16px;}
.col2{grid-column:span 2;}

/* TREND CHART */
.chart-wrap{height:170px;position:relative;}
.pctrls{display:flex;gap:5px;}
.pctrl{font-family:'Space Mono',monospace;font-size:.6rem;padding:4px 10px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;letter-spacing:.06em;text-transform:uppercase;transition:all .2s;}
.pctrl.active,.pctrl:hover{background:rgba(0,229,160,.08);border-color:rgba(0,229,160,.3);color:var(--accent);}
.chart-legend{display:flex;gap:18px;margin-top:12px;}
.leg{display:flex;align-items:center;gap:6px;font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);}
.leg-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}

/* APP LIST */
.app-item{display:flex;align-items:center;gap:12px;padding:12px 20px;border-bottom:1px solid rgba(26,26,46,.8);transition:background .2s;}
.app-item:last-child{border-bottom:none;}
.app-item:hover{background:rgba(0,229,160,.02);}
.app-rank{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);min-width:16px;text-align:right;}
.app-ico{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0;}
.app-info{flex:1;min-width:0;}
.app-name{font-size:.86rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.app-pkg{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);margin-top:1px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.app-bar-col{width:90px;flex-shrink:0;}
.app-bar{height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-bottom:3px;}
.app-bar-fill{height:100%;border-radius:2px;transition:width 1.2s ease;}
.app-bytes{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);text-align:right;}
.hot-tag{font-family:'Space Mono',monospace;font-size:.56rem;padding:2px 6px;background:rgba(255,77,0,.12);color:var(--accent2);border-radius:2px;flex-shrink:0;}
.norm-tag{font-family:'Space Mono',monospace;font-size:.56rem;padding:2px 6px;background:rgba(0,229,160,.08);color:var(--accent);border-radius:2px;flex-shrink:0;}
.block-btn{font-family:'Space Mono',monospace;font-size:.56rem;padding:4px 8px;border:1px solid var(--border);background:none;color:var(--muted);cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.04em;flex-shrink:0;white-space:nowrap;}
.block-btn:hover,.block-btn.blocked{border-color:rgba(255,77,0,.3);color:var(--accent2);background:rgba(255,77,0,.08);}

/* DONUT */
.donut-wrap{position:relative;width:130px;height:130px;margin:16px auto 12px;}
.donut-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;}
.donut-val{font-family:'Syne',sans-serif;font-size:1.3rem;font-weight:800;}
.donut-key{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);text-transform:uppercase;}
.dl-item{display:flex;align-items:center;gap:8px;padding:7px 20px;border-bottom:1px solid rgba(26,26,46,.5);}
.dl-item:last-child{border-bottom:none;}
.dl-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.dl-name{font-size:.82rem;flex:1;}
.dl-pct{font-family:'Space Mono',monospace;font-size:.62rem;color:var(--muted);}

/* SAVINGS */
.savings-big{text-align:center;padding:28px 20px 16px;}
.savings-amount{font-family:'Syne',sans-serif;font-size:3rem;font-weight:800;color:var(--accent);line-height:1;}
.savings-cur{font-size:1.6rem;vertical-align:top;margin-top:4px;display:inline-block;}
.savings-lbl{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:.12em;margin-top:8px;}
.srow{display:flex;justify-content:space-between;align-items:center;padding:11px 20px;border-bottom:1px solid var(--border);}
.srow:last-child{border-bottom:none;}
.srow-key{font-family:'Space Mono',monospace;font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;}
.srow-val{font-family:'Syne',sans-serif;font-size:.95rem;font-weight:700;color:var(--accent);}

/* VARIANCE GAUGE */
.gauge-area{padding:20px;text-align:center;}
.gauge{width:160px;height:80px;margin:0 auto 12px;position:relative;}
.gauge svg{width:100%;height:100%;}
.gauge-num{font-family:'Syne',sans-serif;font-size:1.8rem;font-weight:800;line-height:1;}
.gauge-sub{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);margin-top:4px;text-transform:uppercase;letter-spacing:.08em;}
.v-row{display:flex;justify-content:space-between;font-family:'Space Mono',monospace;font-size:.62rem;margin-bottom:6px;}
.v-row span:first-child{color:var(--muted);}
.v-bar{height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-bottom:12px;}
.v-fill{height:100%;border-radius:2px;transition:width 1.2s ease;}
.gauge-alert{font-family:'Space Mono',monospace;font-size:.65rem;padding:10px 14px;letter-spacing:.04em;margin-top:8px;}
.gauge-alert.danger{background:rgba(255,77,0,.1);border:1px solid rgba(255,77,0,.25);color:var(--accent2);}
.gauge-alert.ok{background:rgba(0,229,160,.08);border:1px solid rgba(0,229,160,.2);color:var(--accent);}

/* ANOMALIES */
.anom-item{display:flex;gap:12px;padding:13px 20px;border-bottom:1px solid rgba(26,26,46,.8);align-items:flex-start;}
.anom-item:last-child{border-bottom:none;}
.anom-sev{width:3px;border-radius:2px;align-self:stretch;flex-shrink:0;min-height:38px;}
.anom-sev.high{background:var(--accent2);box-shadow:0 0 8px rgba(255,77,0,.4);}
.anom-sev.medium{background:#ffbd2e;}
.anom-sev.low{background:var(--accent);}
.anom-app{font-family:'Space Mono',monospace;font-size:.68rem;color:var(--text);margin-bottom:3px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.anom-detail{font-size:.78rem;color:var(--muted);line-height:1.5;}
.anom-meta{display:flex;gap:6px;margin-top:5px;flex-wrap:wrap;align-items:center;}
.anom-tag{font-family:'Space Mono',monospace;font-size:.56rem;padding:2px 6px;border:1px solid var(--border);color:var(--muted);}
.anom-tag.d{border-color:rgba(255,77,0,.3);color:var(--accent2);}
.anom-time{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);margin-left:auto;}

/* BLOCKED */
.blocked-item{display:flex;align-items:center;gap:12px;padding:12px 20px;border-bottom:1px solid rgba(26,26,46,.8);}
.blocked-item:last-child{border-bottom:none;}
.b-ico{width:28px;height:28px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:.9rem;filter:grayscale(1);opacity:.5;flex-shrink:0;}
.b-name{font-size:.84rem;color:var(--muted);text-decoration:line-through;flex:1;}
.b-reason{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--accent2);margin-top:2px;}
.unblock-btn{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);background:none;border:1px solid var(--border);padding:4px 8px;cursor:pointer;transition:all .2s;text-transform:uppercase;}
.unblock-btn:hover{color:var(--accent);border-color:rgba(0,229,160,.3);}

/* DISPUTES */
.dtable{width:100%;border-collapse:collapse;}
.dtable th{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;text-align:left;padding:0 14px 12px;border-bottom:1px solid var(--border);white-space:nowrap;}
.dtable td{font-size:.82rem;padding:12px 14px;border-bottom:1px solid rgba(26,26,46,.5);vertical-align:middle;}
.dtable tr:hover td{background:rgba(0,229,160,.015);}
.dref{font-family:'Space Mono',monospace;font-size:.68rem;color:var(--accent);}
.ds{font-family:'Space Mono',monospace;font-size:.56rem;padding:3px 7px;letter-spacing:.04em;text-transform:uppercase;}
.ds.submitted{background:rgba(0,229,160,.1);color:var(--accent);border:1px solid rgba(0,229,160,.2);}
.ds.pending{background:rgba(255,189,46,.1);color:#ffbd2e;border:1px solid rgba(255,189,46,.2);}
.ds.resolved{background:rgba(123,97,255,.1);color:var(--accent3);border:1px solid rgba(123,97,255,.2);}
.ds.pdf_generated{background:rgba(0,229,160,.04);color:var(--muted);border:1px solid var(--border);}
.abtn{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);background:none;border:1px solid var(--border);padding:4px 9px;cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.04em;text-decoration:none;display:inline-block;}
.abtn:hover{color:var(--accent);border-color:rgba(0,229,160,.3);}
.abtn.p{color:var(--accent);border-color:rgba(0,229,160,.25);background:rgba(0,229,160,.05);}

/* QUICK ACTIONS */
.qa-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:16px 20px;}
.qa{display:flex;align-items:center;gap:10px;padding:12px 14px;border:1px solid var(--border);background:var(--surface);cursor:pointer;text-decoration:none;color:var(--text);transition:all .2s;}
.qa:hover{border-color:rgba(0,229,160,.25);background:rgba(0,229,160,.03);}
.qa-ico{font-size:1.1rem;flex-shrink:0;}
.qa-lbl{font-size:.82rem;font-weight:500;}
.qa-sub{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);text-transform:uppercase;letter-spacing:.05em;margin-top:1px;}

/* TOAST */
.toast{position:fixed;bottom:26px;right:26px;background:var(--surface);border:1px solid var(--border);padding:13px 18px;font-family:'Space Mono',monospace;font-size:.7rem;z-index:9000;transform:translateY(80px);opacity:0;transition:all .4s cubic-bezier(.22,.68,0,1.21);max-width:300px;}
.toast.show{transform:translateY(0);opacity:1;}
.toast.success{border-color:rgba(0,229,160,.3);color:var(--accent);}
.toast.warn{border-color:rgba(255,77,0,.3);color:var(--accent2);}

.skel{height:12px;border-radius:2px;margin-bottom:8px;background:linear-gradient(90deg,var(--border) 25%,rgba(26,26,46,.8) 50%,var(--border) 75%);background-size:200% 100%;animation:skel 1.4s ease infinite;}
@keyframes skel{0%{background-position:200% 0;}100%{background-position:-200% 0;}}
.empty{text-align:center;padding:32px 20px;color:var(--muted);font-family:'Space Mono',monospace;font-size:.68rem;}

@media(max-width:1200px){.stats-grid{grid-template-columns:repeat(3,1fr);}.grid3{grid-template-columns:1fr 1fr;}.col2{grid-column:span 1;}}
@media(max-width:900px){.sidebar{display:none;}.main{margin-left:0;}.topbar{padding:14px 18px;}.content{padding:16px;}.stats-grid{grid-template-columns:1fr 1fr;}.grid2,.grid3{grid-template-columns:1fr;}.ks-bar{padding:14px 18px;}}
</style>
</head>
<body>
<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursorRing"></div>

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <a href="index.html">Ai<span>Tel</span>Da</a>
    <span class="logo-version">v2.1</span>
  </div>
  <nav class="sidebar-nav">
    <div class="nav-section-label">Monitoring</div>
    <a href="dashboard.html" class="nav-item active"><span class="nav-icon">üìä</span>Dashboard</a>
    <a href="#trend" class="nav-item"><span class="nav-icon">üì°</span>Live Sessions</a>
    <a href="#anomalies" class="nav-item"><span class="nav-icon">‚ö†Ô∏è</span>Anomalies<span class="nav-badge" id="sb1">3</span></a>
    <a href="#blocked" class="nav-item"><span class="nav-icon">üö´</span>Blocked Apps<span class="nav-badge green" id="sb2">1</span></a>
    <div class="nav-section-label">Disputes</div>
    <a href="#disputes" class="nav-item"><span class="nav-icon">‚öñÔ∏è</span>My Disputes</a>
    <a href="#" class="nav-item"><span class="nav-icon">üìÑ</span>Reports</a>
    <div class="nav-section-label">Insights</div>
    <a href="#usage" class="nav-item"><span class="nav-icon">üì±</span>App Breakdown</a>
    <a href="#savings" class="nav-item"><span class="nav-icon">üí∞</span>Savings Tracker</a>
    <div class="nav-section-label">Help</div>
    <a href="help.html" class="nav-item"><span class="nav-icon">üõü</span>Help Centre</a>
    <a href="blog.html" class="nav-item"><span class="nav-icon">üì∞</span>News &amp; Blog</a>
  </nav>
  <div class="sidebar-footer">
    <div class="user-chip">
      <div class="user-avatar" id="userAvatar">A</div>
      <div class="user-info">
        <div class="user-name" id="userName">Loading...</div>
        <div class="user-role">Consumer</div>
      </div>
      <button class="logout-btn" onclick="logout()" title="Logout">‚èª</button>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <div>
      <h1>Audit Dashboard</h1>
      <div class="topbar-sub" id="topbarDate">‚Äî</div>
    </div>
    <div class="sentinel-pill" id="sentinelPill"><div class="pulse-dot on" id="pDot"></div><span id="sentinelLabel">Packet-Sentry: Active</span></div>
  </div>

  <!-- KILL SWITCH BAR -->
  <div class="ks-bar">
    <label class="ks-toggle">
      <input type="checkbox" id="ksInput" checked onchange="toggleKS()">
      <div class="ks-track"><div class="ks-thumb"></div></div>
    </label>
    <div class="ks-label">
      <strong id="ksStatus" style="color:var(--accent)">Kill Switch: ON</strong>
      <span id="ksDesc">Phantom background data is blocked. Flagged apps are throttled at socket level.</span>
    </div>
    <div class="ks-sep"></div>
    <div class="ks-stat"><div class="val" style="color:var(--accent2)">847 MB</div><div class="lbl">Blocked Today</div></div>
    <div class="ks-sep"></div>
    <div class="ks-stat"><div class="val" style="color:var(--accent3)">4</div><div class="lbl">Apps Throttled</div></div>
    <div class="ks-sep"></div>
    <div class="ks-savings">
      <div class="big">‚Ç¶<span id="ksAmt">3,240</span></div>
      <div class="lbl">Saved This Month</div>
    </div>
  </div>

  <!-- LIVE TICKER -->
  <div class="live-ticker">
    <div class="ticker-label"><div class="pulse-dot on" style="width:5px;height:5px"></div>LIVE</div>
    <div class="ticker-scroll"><div class="ticker-inner" id="ticker"></div></div>
  </div>

  <div class="content">

    <!-- STATS ROW -->
    <div class="stats-grid">
      <div class="stat-card s1"><div class="stat-icon">üì°</div><div class="stat-label">Data Monitored Today</div><div class="stat-value">2.34 GB</div><div class="stat-sub"><span class="up">‚Üë 12%</span> vs yesterday</div><div class="sparkline" id="sp1"></div></div>
      <div class="stat-card s2"><div class="stat-icon">üö´</div><div class="stat-label">Phantom Blocked</div><div class="stat-value">847 MB</div><div class="stat-sub"><span class="dn">‚Üì 3%</span> vs yesterday</div><div class="sparkline" id="sp2"></div></div>
      <div class="stat-card s3"><div class="stat-icon">‚ö†Ô∏è</div><div class="stat-label">Anomalies (30d)</div><div class="stat-value">23</div><div class="stat-sub"><span class="up">‚Üì 18%</span> improving</div><div class="sparkline" id="sp3"></div></div>
      <div class="stat-card s4"><div class="stat-icon">‚öñÔ∏è</div><div class="stat-label">Disputes Filed</div><div class="stat-value">3</div><div class="stat-sub"><span class="up">1</span> resolved by NCC</div><div class="sparkline" id="sp4"></div></div>
      <div class="stat-card s5"><div class="stat-icon">üí∞</div><div class="stat-label">Money Saved (MTD)</div><div class="stat-value" style="color:var(--accent)">‚Ç¶3,240</div><div class="stat-sub"><span class="up">‚Üë 43%</span> vs last month</div><div class="sparkline" id="sp5"></div></div>
    </div>

    <!-- REALTIME TREND CHART -->
    <div class="panel" style="margin-bottom:16px;" id="trend">
      <div class="ph">
        <span class="pt">Real-Time Data Usage Trend</span>
        <div class="pctrls">
          <button class="pctrl active" onclick="setRange(this,'1h')">1H</button>
          <button class="pctrl" onclick="setRange(this,'6h')">6H</button>
          <button class="pctrl" onclick="setRange(this,'24h')">24H</button>
          <button class="pctrl" onclick="setRange(this,'7d')">7D</button>
          <button class="pctrl" onclick="setRange(this,'30d')">30D</button>
        </div>
        <div class="tag accent" style="display:flex;gap:5px;align-items:center;"><div class="pulse-dot on" style="width:5px;height:5px;animation:pulse 1.5s ease-in-out infinite"></div>Live ¬∑ updates every 5s</div>
      </div>
      <div class="pb">
        <div class="chart-wrap"><canvas id="trendChart"></canvas></div>
        <div class="chart-legend">
          <div class="leg"><div class="leg-dot" style="background:var(--accent)"></div>Device Recorded</div>
          <div class="leg"><div class="leg-dot" style="background:var(--accent2)"></div>Telco Reported</div>
          <div class="leg"><div class="leg-dot" style="background:var(--accent3)"></div>Blocked (Phantom)</div>
        </div>
      </div>
    </div>

    <!-- APP BREAKDOWN + DONUT -->
    <div class="grid3" id="usage">
      <div class="panel col2">
        <div class="ph"><span class="pt">Per-App Usage Breakdown</span><div style="display:flex;gap:8px;align-items:center;"><span style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted)">Click üö´ to block background</span><span class="tag">All Sessions</span></div></div>
        <div id="appList"></div>
      </div>
      <div class="panel" style="display:flex;flex-direction:column;">
        <div class="ph"><span class="pt">Usage Split</span></div>
        <div style="padding:16px 20px 8px;"><div class="donut-wrap"><canvas id="donutChart"></canvas><div class="donut-center"><div class="donut-val" id="donutV">2.34</div><div class="donut-key">GB total</div></div></div></div>
        <div id="donutLegend"></div>
      </div>
    </div>

    <!-- VARIANCE + SAVINGS + ANOMALIES -->
    <div class="grid3" id="anomalies">
      <!-- VARIANCE GAUGE -->
      <div class="panel">
        <div class="ph"><span class="pt">Billing Variance</span><span class="tag danger">38.01% ‚ö†</span></div>
        <div class="gauge-area">
          <div class="gauge">
            <svg viewBox="0 0 160 80"><defs><linearGradient id="gGrad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#00e5a0"/><stop offset="50%" stop-color="#ffbd2e"/><stop offset="100%" stop-color="#ff4d00"/></linearGradient></defs><path d="M10 80 A70 70 0 0 1 150 80" fill="none" stroke="#1a1a2e" stroke-width="12" stroke-linecap="round"/><path id="gArc" d="M10 80 A70 70 0 0 1 150 80" fill="none" stroke="url(#gGrad)" stroke-width="12" stroke-linecap="round" stroke-dasharray="220" stroke-dashoffset="57"/><circle id="gDot" cx="10" cy="80" r="6" fill="#ff4d00"><animateMotion dur="0s" fill="freeze"><mpath href="#gArc"/></animateMotion></circle></svg>
          </div>
          <div class="gauge-num" style="color:var(--accent2)">38.01%</div>
          <div class="gauge-sub">V = |D_device ‚àí D_telco|</div>
          <div class="gauge-alert danger">‚ö† Over-billing suspected</div>
        </div>
        <div style="padding:0 20px 16px;">
          <div class="v-row"><span>Device Recorded</span><span id="vDev">2.34 GB</span></div>
          <div class="v-bar"><div class="v-fill" style="width:62%;background:var(--accent)"></div></div>
          <div class="v-row"><span>Telco Reported</span><span id="vTelco">3.77 GB</span></div>
          <div class="v-bar"><div class="v-fill" style="width:100%;background:var(--accent2)"></div></div>
          <div style="display:flex;gap:8px;margin-top:10px;">
            <a href="#" class="abtn p" style="flex:1;text-align:center;">Generate PDF</a>
            <a href="#" class="abtn" style="flex:1;text-align:center;">File NCC</a>
          </div>
        </div>
      </div>

      <!-- SAVINGS TRACKER -->
      <div class="panel" id="savings">
        <div class="ph"><span class="pt">Savings Tracker</span><span class="tag accent">This Month</span></div>
        <div class="savings-big">
          <div class="savings-amount"><span class="savings-cur">‚Ç¶</span><span id="savAmt">3,240</span></div>
          <div class="savings-lbl">Recovered / Saved This Month</div>
        </div>
        <div class="srow"><span class="srow-key">Phantom Blocked</span><span class="srow-val">‚Ç¶1,890</span></div>
        <div class="srow"><span class="srow-key">Dispute Resolved</span><span class="srow-val">‚Ç¶1,200</span></div>
        <div class="srow"><span class="srow-key">Kill Switch Active</span><span class="srow-val">‚Ç¶150</span></div>
        <div class="srow" style="border-top:1px solid rgba(0,229,160,.15);"><span class="srow-key" style="color:var(--accent)">All-Time Total</span><span class="srow-val">‚Ç¶12,600</span></div>
        <div style="padding:12px 20px 16px;"><div style="background:rgba(0,229,160,.05);border:1px solid rgba(0,229,160,.15);padding:12px;font-family:'Space Mono',monospace;font-size:.62rem;color:var(--muted);line-height:1.6;">üí° At current rate ‚Üí <strong style="color:var(--accent)">‚Ç¶38,880/yr</strong> saved with AiTelDa.</div></div>
      </div>

      <!-- ANOMALY FEED -->
      <div class="panel">
        <div class="ph"><span class="pt">Live Anomaly Feed</span><span class="tag danger" id="anomCount">3 events</span></div>
        <div id="anomalyList"></div>
      </div>
    </div>

    <!-- BLOCKED APPS + DISPUTES -->
    <div class="grid2" id="blocked">
      <div class="panel">
        <div class="ph"><span class="pt">Blocked Apps</span><span class="tag danger" id="blockedTag">1 Blocked</span></div>
        <div id="blockedList"></div>
        <div style="padding:12px 20px 14px;border-top:1px solid var(--border);font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);line-height:1.6;">Blocked apps cannot use background data. They work normally when open and on-screen.</div>
      </div>

      <div class="panel" id="disputes">
        <div class="ph"><span class="pt">Dispute Cases</span><button class="abtn p" onclick="toast('Dispute wizard launching‚Ä¶','success')">+ New Dispute</button></div>
        <div style="overflow-x:auto;" id="disputeWrap"></div>
        <div class="qa-grid">
          <a href="help.html" class="qa"><span class="qa-ico">üõü</span><div><div class="qa-lbl">Help Centre</div><div class="qa-sub">FAQs &amp; Guides</div></div></a>
          <a href="blog.html" class="qa"><span class="qa-ico">üì∞</span><div><div class="qa-lbl">Telco News</div><div class="qa-sub">Latest Updates</div></div></a>
          <a href="#" class="qa"><span class="qa-ico">üìÑ</span><div><div class="qa-lbl">Download Report</div><div class="qa-sub">Forensic PDF</div></div></a>
          <a href="#" class="qa"><span class="qa-ico">üì±</span><div><div class="qa-lbl">Add Device</div><div class="qa-sub">Register New</div></div></a>
        </div>
      </div>
    </div>

  </div>
</main>

<div class="toast" id="toast"></div>

<script>
const cursor=document.getElementById('cursor'),ring=document.getElementById('cursorRing');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;cursor.style.left=mx+'px';cursor.style.top=my+'px';});
(function a(){rx+=(mx-rx)*.12;ry+=(my-ry)*.12;ring.style.left=rx+'px';ring.style.top=ry+'px';requestAnimationFrame(a);})();
document.querySelectorAll('a,button,input,label,.nav-item').forEach(el=>{
  el.addEventListener('mouseenter',()=>{ring.style.width='50px';ring.style.height='50px';});
  el.addEventListener('mouseleave',()=>{ring.style.width='36px';ring.style.height='36px';});
});

// Utils
function fmtB(b){if(!b)return'0B';if(b<1048576)return(b/1024).toFixed(0)+'KB';if(b<1073741824)return(b/1048576).toFixed(1)+'MB';return(b/1073741824).toFixed(2)+'GB';}
function rand(a,b){return Math.random()*(b-a)+a;}
function toast(msg,type='success'){const t=document.getElementById('toast');t.textContent=msg;t.className='toast '+type+' show';setTimeout(()=>t.className='toast',3200);}
function counter(elId,target){let c=0;const s=target/60;const iv=setInterval(()=>{c=Math.min(c+s,target);document.getElementById(elId).textContent=Math.floor(c).toLocaleString();if(c>=target)clearInterval(iv);},16);}

// Auth
const token=localStorage.getItem('aitelda_token');
const user=JSON.parse(localStorage.getItem('aitelda_user')||'{}');
if(!token)window.location.href='login.html';
const name=user.full_name||user.email||'User';
document.getElementById('userName').textContent=name;
document.getElementById('userAvatar').textContent=name.charAt(0).toUpperCase();
document.getElementById('topbarDate').textContent=new Date().toLocaleDateString('en-GB',{weekday:'long',year:'numeric',month:'long',day:'numeric'});

// TICKER
const tItems=[{l:'TikTok background',v:'+1730%',c:'red'},{l:'MTN Variance',v:'38.01%',c:'red'},{l:'Blocked today',v:'847 MB',c:''},{l:'Savings MTD',v:'‚Ç¶3,240',c:'green'},{l:'Dispute AIT-2026-8C4072',v:'Submitted',c:'green'},{l:'WhatsApp idle',v:'+89%',c:'red'},{l:'Aura-Brain',v:'Running',c:'green'},{l:'Last anomaly',v:'2h ago',c:''},{l:'NCC ¬ß5.3 claim',v:'Active',c:'green'},{l:'Packet sessions',v:'14 today',c:''}];
const mk=()=>tItems.map(d=>`<span class="ticker-item">${d.l}: <span class="${d.c}">${d.v}</span></span>`).join('');
document.getElementById('ticker').innerHTML=mk()+mk();

// SPARKLINES
function spark(id,vals,col){const mx=Math.max(...vals);document.getElementById(id).innerHTML=vals.map(v=>`<div class="sp-bar" style="flex:1;height:${Math.max(10,(v/mx)*100)}%;background:${col}26;border-top:1px solid ${col}"></div>`).join('');}
spark('sp1',[12,18,14,22,19,24,28,20,23,25,21,27],'var(--accent)');
spark('sp2',[8,11,9,6,7,4,5,3,4,2,3,2],'var(--accent2)');
spark('sp3',[6,8,3,5,9,4,2,7,3,5,4,3],'#ffbd2e');
spark('sp4',[0,0,1,0,1,1,1,1,2,2,3,3],'var(--accent3)');
spark('sp5',[320,280,410,380,520,480,560,490,640,580,720,810],'var(--accent)');

// KILL SWITCH
function toggleKS(){
  const on=document.getElementById('ksInput').checked;
  document.getElementById('ksStatus').textContent=on?'Kill Switch: ON':'Kill Switch: OFF';
  document.getElementById('ksStatus').style.color=on?'var(--accent)':'var(--accent2)';
  document.getElementById('ksDesc').textContent=on?'Phantom background data is blocked. Flagged apps are throttled at socket level.':'Kill Switch disabled. All apps can use background data freely. Monitoring only.';
  const pill=document.getElementById('sentinelPill'),dot=document.getElementById('pDot'),lbl=document.getElementById('sentinelLabel');
  if(on){pill.className='sentinel-pill';dot.className='pulse-dot on';lbl.textContent='Packet-Sentry: Active';}
  else{pill.className='sentinel-pill off';dot.className='pulse-dot off';lbl.textContent='Packet-Sentry: Paused';}
  toast(on?'üõ°Ô∏è Kill Switch ON ‚Äî phantom data blocked':'‚ö†Ô∏è Kill Switch OFF ‚Äî monitoring only',on?'success':'warn');
}

// TREND CHART
let tChart;
function genData(range){
  const pts={['1h']:12,['6h']:18,['24h']:24,['7d']:28,['30d']:30}[range]||12;
  const labels=[],device=[],telco=[],blocked=[];
  for(let i=0;i<pts;i++){
    const t=new Date(Date.now()-((pts-1-i)*({'1h':300,'6h':1200,'24h':3600,'7d':21600,'30d':86400}[range]||300)*1000));
    labels.push(range==='30d'||range==='7d'?t.toLocaleDateString('en-GB',{month:'short',day:'numeric'}):t.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'}));
    const m=range==='7d'?8:range==='30d'?24:1;
    const dv=rand(40,200)*m;device.push(+dv.toFixed(1));telco.push(+(dv*(1+rand(.06,.45))).toFixed(1));blocked.push(+(rand(5,50)*m).toFixed(1));
  }
  return{labels,device,telco,blocked};
}
function drawTrend(range){
  const{labels,device,telco,blocked}=genData(range);
  const ctx=document.getElementById('trendChart').getContext('2d');
  if(tChart)tChart.destroy();
  tChart=new Chart(ctx,{type:'line',data:{labels,datasets:[
    {label:'Device',data:device,borderColor:'#00e5a0',backgroundColor:'rgba(0,229,160,.06)',borderWidth:2,pointRadius:0,tension:.4,fill:true},
    {label:'Telco',data:telco,borderColor:'#ff4d00',backgroundColor:'rgba(255,77,0,.06)',borderWidth:2,pointRadius:0,tension:.4,fill:true},
    {label:'Blocked',data:blocked,borderColor:'#7b61ff',backgroundColor:'rgba(123,97,255,.06)',borderWidth:2,pointRadius:0,tension:.4,fill:true},
  ]},options:{responsive:true,maintainAspectRatio:false,interaction:{mode:'index',intersect:false},
    plugins:{legend:{display:false},tooltip:{backgroundColor:'#0f0f1a',borderColor:'#1a1a2e',borderWidth:1,titleFont:{family:'Space Mono',size:10},bodyFont:{family:'Space Mono',size:10},callbacks:{label:c=>`${c.dataset.label}: ${c.parsed.y.toFixed(1)} MB`}}},
    scales:{x:{grid:{color:'rgba(26,26,46,.8)'},ticks:{color:'#6b6b80',font:{family:'Space Mono',size:9},maxTicksLimit:8}},y:{grid:{color:'rgba(26,26,46,.8)'},ticks:{color:'#6b6b80',font:{family:'Space Mono',size:9},callback:v=>`${v}MB`}}}
  }});
}
function setRange(btn,r){document.querySelectorAll('.pctrl').forEach(b=>b.classList.remove('active'));btn.classList.add('active');drawTrend(r);}

// DONUT
let dChart;
const dColors=['#00e5a0','#ff4d00','#7b61ff','#ffbd2e','#27c93f'];
const dApps=[{n:'TikTok',p:62},{n:'WhatsApp',p:16},{n:'Instagram',p:10},{n:'Chrome',p:8},{n:'Others',p:4}];
function drawDonut(){
  const ctx=document.getElementById('donutChart').getContext('2d');
  if(dChart)dChart.destroy();
  dChart=new Chart(ctx,{type:'doughnut',data:{labels:dApps.map(a=>a.n),datasets:[{data:dApps.map(a=>a.p),backgroundColor:dColors,borderColor:'#0f0f1a',borderWidth:3,hoverBorderWidth:0}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'72%',plugins:{legend:{display:false},tooltip:{backgroundColor:'#0f0f1a',borderColor:'#1a1a2e',borderWidth:1,bodyFont:{family:'Space Mono',size:10}}}}});
  document.getElementById('donutLegend').innerHTML=dApps.map((a,i)=>`<div class="dl-item"><div class="dl-dot" style="background:${dColors[i]}"></div><span class="dl-name">${a.n}</span><span class="dl-pct">${a.p}%</span></div>`).join('');
}

// APPS
const apps=[
  {name:'TikTok',pkg:'com.tiktok.musically',bytes:1460000000,pct:62,ico:'üéµ',col:'#ff4d00',hot:true,dev:'+1730%'},
  {name:'WhatsApp',pkg:'com.whatsapp',bytes:374000000,pct:16,ico:'üí¨',col:'#27c93f',hot:false,dev:'Normal'},
  {name:'Instagram',pkg:'com.instagram.android',bytes:234000000,pct:10,ico:'üì∑',col:'#7b61ff',hot:true,dev:'+340%'},
  {name:'Chrome',pkg:'com.android.chrome',bytes:187000000,pct:8,ico:'üåê',col:'#00e5a0',hot:false,dev:'Normal'},
  {name:'Gmail',pkg:'com.google.android.gm',bytes:56000000,pct:2.4,ico:'üìß',col:'#ffbd2e',hot:false,dev:'Normal'},
  {name:'Facebook',pkg:'com.facebook.katana',bytes:42000000,pct:1.8,ico:'üë•',col:'#7b61ff',hot:true,dev:'+89%'},
];
let blocked=new Set(['com.tiktok.musically']);
function renderApps(){
  document.getElementById('appList').innerHTML=apps.map((a,i)=>`
    <div class="app-item">
      <div class="app-rank">${String(i+1).padStart(2,'0')}</div>
      <div class="app-ico" style="background:${a.col}1a">${a.ico}</div>
      <div class="app-info">
        <div class="app-name" style="${blocked.has(a.pkg)?'text-decoration:line-through;color:var(--muted)':''}">${a.name}</div>
        <div class="app-pkg">${a.pkg}</div>
      </div>
      <span class="${a.hot?'hot-tag':'norm-tag'}">${a.dev}</span>
      <div class="app-bar-col">
        <div class="app-bar"><div class="app-bar-fill" style="width:${a.pct}%;background:${blocked.has(a.pkg)?'var(--muted)':a.col}"></div></div>
        <div class="app-bytes">${fmtB(a.bytes)}</div>
      </div>
      <button class="block-btn ${blocked.has(a.pkg)?'blocked':''}" onclick="toggleBlock('${a.pkg}','${a.name}')">
        ${blocked.has(a.pkg)?'üö´ Blocked':'Block'}
      </button>
    </div>`).join('');
}
function toggleBlock(pkg,name){
  if(blocked.has(pkg)){blocked.delete(pkg);toast(`‚úì ${name} unblocked`,'success');}
  else{blocked.add(pkg);toast(`üö´ ${name} background blocked`,'warn');}
  renderApps();renderBlocked();
  document.getElementById('blockedTag').textContent=`${blocked.size} Blocked`;
  document.getElementById('sb2').textContent=blocked.size;
}
function renderBlocked(){
  const reasons={'com.tiktok.musically':'1730% idle spike','com.instagram.android':'340% deviation'};
  const bl=apps.filter(a=>blocked.has(a.pkg));
  document.getElementById('blockedList').innerHTML=bl.length===0?`<div class="empty">‚úì No apps blocked</div>`:
    bl.map(a=>`<div class="blocked-item"><div class="b-ico">${a.ico}</div><div style="flex:1"><div class="b-name">${a.name}</div><div class="b-reason">‚ö° ${reasons[a.pkg]||'Manual block'}</div></div><button class="unblock-btn" onclick="toggleBlock('${a.pkg}','${a.name}')">Unblock</button></div>`).join('');
}

// ANOMALIES
const anoms=[
  {app:'com.tiktok.musically',detail:'Background drain ¬∑ Screen off ¬∑ No active session',dev:'+1730%',screen:'OFF',time:'02:14 AM',sev:'high'},
  {app:'com.facebook.katana',detail:'Unexpected background fetch during idle period',dev:'+340%',screen:'OFF',time:'04:52 AM',sev:'medium'},
  {app:'com.google.android.gms',detail:'System services spike ¬∑ Possible OTA trigger',dev:'+28%',screen:'LOCK',time:'07:11 AM',sev:'low'},
];
document.getElementById('anomalyList').innerHTML=anoms.map(a=>`
  <div class="anom-item">
    <div class="anom-sev ${a.sev}"></div>
    <div style="flex:1;min-width:0">
      <div class="anom-app">${a.app}</div>
      <div class="anom-detail">${a.detail}</div>
      <div class="anom-meta">
        <span class="anom-tag d">${a.dev}</span>
        <span class="anom-tag">Screen: ${a.screen}</span>
        <span class="anom-tag">${a.sev.toUpperCase()}</span>
        <span class="anom-time">${a.time}</span>
      </div>
    </div>
  </div>`).join('');
document.getElementById('anomCount').textContent=`${anoms.length} events`;
document.getElementById('sb1').textContent=anoms.length;

// DISPUTES TABLE
const disputes=[
  {ref:'AIT-2026-8C4072',period:'Jan 2026',variance:'38.01%',status:'submitted',pct:38.01},
  {ref:'AIT-2025-3F9A11',period:'Dec 2025',variance:'22.4%',status:'resolved',pct:22.4},
  {ref:'AIT-2025-1D2B88',period:'Nov 2025',variance:'14.2%',status:'pdf_generated',pct:14.2},
];
document.getElementById('disputeWrap').innerHTML=`<table class="dtable"><thead><tr><th>Reference</th><th>Period</th><th>Variance</th><th>Status</th><th></th></tr></thead><tbody>${disputes.map(d=>`<tr><td><span class="dref">${d.ref}</span></td><td style="font-size:.78rem;color:var(--muted)">${d.period}</td><td style="font-family:'Space Mono',monospace;font-size:.72rem;color:${d.pct>5?'var(--accent2)':'var(--accent)'}">${d.variance}</td><td><span class="ds ${d.status}">${d.status.replace('_',' ')}</span></td><td><a href="#" class="abtn">View ‚Üí</a></td></tr>`).join('')}</tbody></table>`;

// LIVE UPDATE SIMULATION
setInterval(()=>{
  const items=document.querySelectorAll('.ticker-item');
  if(items.length){const r=Math.floor(rand(0,items.length/2));const el=items[r].querySelector('span');if(el&&el.className!=='green')el.textContent=`+${Math.floor(rand(50,2000))}%`;}
},4000);

// SAVINGS COUNTER
counter('savAmt',3240);counter('ksAmt',3240);

// INIT
drawTrend('1h');
drawDonut();
renderApps();
renderBlocked();

function logout(){
  const rf=localStorage.getItem('aitelda_refresh');
  if(rf)fetch('http://localhost:5000/api/auth/logout',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify({refresh_token:rf})}).catch(()=>{});
  localStorage.clear();window.location.href='login.html';
}
</script>
</body>
</html>
